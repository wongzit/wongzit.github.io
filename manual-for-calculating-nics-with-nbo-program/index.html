<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="467xC4SA9a1Jn6phdHuh7P3ddDHyokgW6RBNznYrpUI"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Manual for Calculating NICS with NBO Program | Dr. Zhe WANG </title> <meta name="author" content="Dr. Zhe WANG"> <meta name="description" content="Personal homepage of ZW. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon_2.png?747804bee05bfe8f8ad3dbba91dc77aa"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://wongzit.github.io/manual-for-calculating-nics-with-nbo-program/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <img src="/assets/img/favicon_2.png?747804bee05bfe8f8ad3dbba91dc77aa" alt="Site Icon" style="height: 50px;"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Dr.</span> Zhe WANG </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">research </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/presentations/">presentations </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">programs </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/program/pyaroma/">py.Aroma</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/uvplotter/">uv.Plotter</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/script/">scripts</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/online/molview.html">mol.Viewer</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/links/">links </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Manual for Calculating NICS with NBO Program</h1> <p class="post-meta"> Created on September 02, 2021 by Zhe Wang </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2021   ·   <i class="fa-solid fa-hashtag fa-sm"></i> Gaussian   <i class="fa-solid fa-hashtag fa-sm"></i> NBO   <i class="fa-solid fa-hashtag fa-sm"></i> Computation </p> </header> <article class="post-content"> <div id="markdown-content"> <blockquote> <p>This post records a general manual for calculating NICS index using NBO program. About NICS index, please refer to this OL <a href="https://doi.org/10.1021/ol0529546" rel="external nofollow noopener" target="_blank">paper</a>.</p> </blockquote> <p><strong>Note:</strong> Input and output files could be found <a href="https://github.com/wongzit/blogFiles/tree/main/blog_nics_index" rel="external nofollow noopener" target="_blank">here</a>.</p> <p><strong>Contents</strong></p> <ul> <li><a href="https://wongzit.github.io/manual-for-calculating-nics-with-nbo-program/#1-input">1. Input</a></li> <li><a href="https://wongzit.github.io/manual-for-calculating-nics-with-nbo-program/#2-output">2. Output</a></li> <li><a href="https://wongzit.github.io/manual-for-calculating-nics-with-nbo-program/#3-issues-about-running-of-nbo">3. Issues about Running of NBO</a></li> </ul> <h1 id="1-input">1. Input</h1> <p>The input file for calculating NICS(0) and NICS(1/-1) for benzene is given below. The commercially abailable NBO 7.0 program will be used, if you are using NBO 3 embedded in Gaussian, this manual is not suitable for you since some NBO keywords are not available for the old version of NBO.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%nprocshared=8
%mem=10GB
%chk=benzene_nics_nbo.chk
# B3LYP/6-31+G(d) NMR pop=nbo7read iop(10/46=1)

NICSinput//Created_by_py.Aroma

0 1
 C           -1.339236           -0.395853            0.000005
 C           -0.326685           -1.357730            0.000069
 C            1.012421           -0.961878           -0.000055
 C            1.339202            0.395965            0.000008
 C            0.326798            1.357700            0.000062
 C           -1.012501            0.961798           -0.000058
 H           -2.381330           -0.704010           -0.000066
 H           -0.581086           -2.414245            0.000079
 H            1.800375           -1.710234           -0.000154
 H            2.381367            0.703858            0.000007
 H            0.580952            2.414267            0.000018
 H           -1.800276            1.710353           -0.000063
 Bq          -0.000006           -0.000010            0.000004
 Bq           0.000009           -0.000057            1.000004
 Bq          -0.000020            0.000036           -0.999996

$NBO NPA NBO NBOSUM BNDIDX E2PERT NLMO DIPOLE CMO NRT NCS &lt;XYZ MO&gt; $END

</code></pre></div></div> <h1 id="2-output">2. Output</h1> <p>NBO 7.0 program is appled, following information could be found in the output file, you could find the discription for each NBO keywords.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> *********************************** NBO 7.0 ***********************************
             N A T U R A L   A T O M I C   O R B I T A L   A N D
          N A T U R A L   B O N D   O R B I T A L   A N A L Y S I S
 ****************************** Zhe Wang (I102139) *****************************
  (c) Copyright 1996-2021 Board of Regents of the University of Wisconsin System
      on behalf of the Theoretical Chemistry Institute.  All rights reserved.

          Cite this program [NBO 7.0.10 (8-Feb-2021)] as:

          NBO 7.0.  E. D. Glendening, J. K. Badenhoop, A. E. Reed,
          J. E. Carpenter, J. A. Bohmann, C. M. Morales, P. Karafiloglou,
          C. R. Landis, and F. Weinhold, Theoretical Chemistry Institute,
          University of Wisconsin, Madison, WI (2018)

       /NPA    / : Natural Population Analysis
       /NBO    / : Natural Bond Orbital Analysis
       /NBOSUM / : Print summary of the NBO analysis
       /NLMO   / : Form natural localized molecular orbitals
       /NRT    / : Natural Resonance Theory Analysis
       /NCS    / : Natural Chemical Shielding Analysis
                     including chemical shielding anisotropy
                     in the molecular Cartesian axes
                     NCS Analysis with canonical MOs
       /E2PERT / : Print perturbative analysis of NBO Fock matrix
       /DIPOLE / : Print NBO/NLMO dipole moment analysis
       /CMO    / : Print NBO analysis of canonical MOs
       /BNDIDX / : Print bond indices based on the NAO density matrix
</code></pre></div></div> <p>Search <code class="language-plaintext highlighter-rouge">Cartesian XYZ to principal shielding axes for atom</code> in the output file, you could find following output for every atoms, we only need to concern about the ghost atoms (Bq).</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Cartesian XYZ to principal shielding axes for atom gh ( 13):

        1         2         3
 -------------------------------
  X  0.818687  0.574240 -0.000004
  Y -0.574240  0.818687  0.000009
  Z  0.000008 -0.000005  1.000000

 Full Cartesian NMR shielding tensor (ppm) for atom gh( 13):
 Canonical MO contributions

   MO        XX      XY      XZ      YX      YY      YZ      ZX      ZY      ZZ
 ===============================================================================
    2.      0.10   -0.06    0.00   -0.06   -0.25    0.00    0.00    0.00    0.94
    3.     -0.25    0.06    0.00    0.06    0.10    0.00    0.00    0.00    0.94
    4.      0.06   -0.02    0.00   -0.02   -0.08    0.00    0.00    0.00    2.45
    5.     -0.08    0.03    0.00    0.03    0.06    0.00    0.00    0.00    2.45
    6.      0.05    0.00    0.00    0.00    0.05    0.00    0.00    0.00    3.84
    7.      5.27    0.00    0.00    0.00    5.27    0.00    0.00    0.00   14.39
    8.      2.32    2.03    0.00    2.03    2.03    0.00    0.00    0.00   10.77
    9.      2.03   -2.03    0.00   -2.03    2.32    0.00    0.00    0.00   10.77
   10.      3.12   -0.18    0.00   -0.18    1.84    0.00    0.00    0.00    6.30
   11.      1.84    0.18    0.00    0.18    3.12    0.00    0.00    0.00    6.30
   12.      4.74    0.00    0.00    0.00    4.74    0.00    0.00    0.00   11.79
   13.     -1.04    0.00    0.00    0.00   -1.04    0.00    0.00    0.00   -1.15
   14.    -10.98    0.00    0.00    0.00  -10.99    0.00    0.00    0.00    1.37
   15.      2.13    1.57    0.00    1.57  -13.10    0.00    0.00    0.00  -11.99
   16.    -13.10   -1.57    0.00   -1.57    2.13    0.00    0.00    0.00  -11.99
   17.     15.14    0.00    0.00    0.00   15.14    0.00    0.00    0.00   12.81
   18.     -1.65   -0.98    0.00   -0.98   -8.08    0.00    0.00    0.00  -35.01
   19.     -8.08    0.98    0.00    0.98   -1.65    0.00    0.00    0.00  -35.01
   20.     -3.64    4.51    0.00    4.51    7.48    0.00    0.00    0.00   11.64
   21.      7.48   -4.51    0.00   -4.51   -3.64    0.00    0.00    0.00   11.64
 -------------------------------------------------------------------------------
   Total    5.43    0.00    0.00    0.00    5.43    0.00    0.00    0.00   13.18
 -------------------------------------------------------------------------------

 Principal components of the tensor (ppm) for atom gh( 13):
 Canonical MO contributions

        MO                 11      22      33     CSA     ISO
 =============================================================
    2.                      0.04   -0.19    0.94    1.01    0.26
    3.                     -0.19    0.04    0.94    1.01    0.26
    4.                      0.04   -0.06    2.45    2.46    0.81
    5.                     -0.06    0.04    2.45    2.46    0.81
    6.                      0.05    0.05    3.84    3.80    1.31
    7.                      5.27    5.27   14.39    9.12    8.31
    8.                      0.32    4.04   10.77    8.59    5.04
    9.                      4.04    0.32   10.77    8.59    5.04
   10.                      2.86    2.10    6.30    3.82    3.75
   11.                      2.10    2.86    6.30    3.83    3.75
   12.                      4.74    4.74   11.79    7.05    7.09
   13.                     -1.04   -1.04   -1.15   -0.11   -1.07
   14.                    -10.99  -10.99    1.37   12.36   -6.87
   15.                     -4.37   -6.60  -11.99   -6.50   -7.65
   16.                     -6.60   -4.37  -11.99   -6.51   -7.65
   17.                     15.14   15.14   12.81   -2.33   14.36     #
   18.                     -2.85   -6.88  -35.01  -30.14  -14.91
   19.                     -6.88   -2.85  -35.01  -30.15  -14.91
   20.                     -4.21    8.06   11.64    9.71    5.16     #
   21.                      8.05   -4.21   11.64    9.72    5.16     #
 -------------------------------------------------------------
                 Total    5.43    5.43   13.18    7.75    8.02       #
 -------------------------------------------------------------
</code></pre></div></div> <p>For benzene, molecular orbitals 17, 20 and 21 can be identified as the π-orbitals. NICS values are sign-reversed shielding tensors. Focus on the lines marked with # symbol in the second table, we could find:</p> <ul> <li> <strong>NICS</strong>πzz = -(12.81+11.64+11.64) = -36.09</li> <li> <strong>NICS</strong>zz = -13.18</li> <li> <strong>NICS</strong>π = -(14.36+5.16+5.16) = -24.68</li> <li> <strong>NICS</strong>iso = -8.02</li> </ul> <h1 id="3-issues-about-running-of-nbo">3. Issues about Running of NBO</h1> <h2 id="running-nbo-70-with-gaussian-16">Running NBO 7.0 with Gaussian 16</h2> <ul> <li>For Gaussian 16 <strong>B</strong>.01, use keyword <code class="language-plaintext highlighter-rouge">pop=nbo6read</code> to read additional NBO <strong>7.0</strong> keyword.</li> <li>For Gaussian 16 <strong>C</strong>.01, use keyword <code class="language-plaintext highlighter-rouge">pop=nbo7read</code> to read additional NBO <strong>7.0</strong> keyword.</li> </ul> <h2 id="memo-running-nbo-70-with-47-files">MEMO: Running NBO 7.0 with .47 Files</h2> <p>1) Run Gaussian to get <em>.47</em> file:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># ... pop=nboread

...

$NBO ARCHIVE FILE=filename $END

</code></pre></div></div> <p>2) Open the <em>.47</em> file with text editor, add NBO keyword between <code class="language-plaintext highlighter-rouge">$NBO</code> and <code class="language-plaintext highlighter-rouge">$END</code> in the 2nd line, save it.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> $NBO NPA NBO NBOSUM BNDIDX E2PERT NLMO DIPOLE CMO NRT NCS &lt;XYZ MO&gt; $END
</code></pre></div></div> <p>3) Execute <code class="language-plaintext highlighter-rouge">gennbo filename</code> command to run NBO, the <em>.47</em> should not be included in the command.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/orbital-composition-analysis/">Orbital Composition Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/list-of-all-posts/">List of All Posts</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Dr. Zhe WANG. At <a href="https://www.applchem.eng.osaka-u.ac.jp" target="_blank" rel="external nofollow noopener">Graduate School of Engineering</a>, <a href="https://www.osaka-u.ac.jp/en" rel="external nofollow noopener" target="_blank">The University of Osaka</a>. Last updated: September 30, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>