<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="467xC4SA9a1Jn6phdHuh7P3ddDHyokgW6RBNznYrpUI"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> NICS Analyses with NICSgen | Dr. Zhe WANG </title> <meta name="author" content="Dr. Zhe WANG"> <meta name="description" content="Personal homepage of ZW. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon_2.png?747804bee05bfe8f8ad3dbba91dc77aa"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://wongzit.github.io/nics-analyses-with-nicsgen/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <img src="/assets/img/favicon_2.png?747804bee05bfe8f8ad3dbba91dc77aa" alt="Site Icon" style="height: 38px;"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Dr.</span> Zhe WANG </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">research </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/presentations/">presentations </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">programs </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/program/pyaroma/">py.Aroma</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/uvplotter/">uv.Plotter</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/script/">scripts</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/online/molview.html">mol.Viewer</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/links/">links </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">NICS Analyses with NICSgen</h1> <p class="post-meta"> Created on June 03, 2021 by Zhe Wang </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2021   ·   <i class="fa-solid fa-hashtag fa-sm"></i> Software   <i class="fa-solid fa-hashtag fa-sm"></i> Computation </p> </header> <article class="post-content"> <div id="markdown-content"> <script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <script type="text/x-mathjax-config">
 MathJax.Hub.Config({
 tex2jax: {
 inlineMath: [['$', '$'] ],
 displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
 }
 });
</script> <p><strong>NICSgen</strong> is end of support. The basic functionalities have been combined into <strong>py.Aroma</strong>, a multi-functional tool for aromaticity analyses. Please check the <a href="https://wongzit.github.io/program/pyaroma/">homepage</a> of <strong>py.Aroma</strong> for more information.</p> <p><strong>Contents</strong></p> <ul> <li><a href="https://wongzit.github.io/nics-analyses-with-nicsgen/#1-statement-of-need">1. Statement of need</a></li> <li><a href="https://wongzit.github.io/nics-analyses-with-nicsgen/#2-mathematic-principle">2. Mathematic Principle</a></li> <li><a href="https://wongzit.github.io/nics-analyses-with-nicsgen/#3-nics-analyses-of-1-methylazulene">3. NICS analyses of 1-methylazulene</a></li> </ul> <h1 id="1-statement-of-need">1. Statement of need</h1> <p>NICS (Nucleus-Independent Chemical Shifts) is a popular method for analyzing aromaticity of cyclic compound, by calculating the magnetic shielding tensor (in ppm) with NMR calculation. In NICS calculation, ghost atoms (Bq) are needed to be included in the input file. NICS(n) is widely used for n = 0 and n = 1 (<a href="https://pubs.acs.org/doi/10.1021/ol0529546" rel="external nofollow noopener" target="_blank">Which NICS aromaticity index for planar π rings is best?</a>), we need to add the ghost atom to the height of 1 Å from the center point of the plane. It is difficult to add the ghost atom accurately. So, I present the Python program NICSgen, to help user add the ghost atom in the right position.</p> <p>NICSgen could be download from homepage and <a href="https://github.com/wongzit/NICSgen" rel="external nofollow noopener" target="_blank"><em>GitHub</em></a>. To install and run the programs, please refer to the user manuals</p> <h1 id="2-mathematic-principle">2. Mathematic Principle</h1> <p>Imagine we have <em>m</em> (<em>m</em> &gt;= 3) points <em>p</em> on plane in Cartesian coordinate space system, the coordinates of these points are:</p> \[p_1 = (x_1,y_1,z_1)\] \[p_2 = (x_2,y_2,z_2)\] \[p_3 = (x_3,y_3,z_3)\] \[\cdots\] \[p_m = (x_m,y_m,z_m)\] <p>So, the center point p(c) of these point should be located at:</p> \[p_c = (x_c,y_c,z_c),{\rm where:}\] \[x_c=\frac{1}{m} \sum_{i=1}^m x_i,\:y_c=\frac{1}{m} \sum_{i=1}^m y_i,\:z_c=\frac{1}{m} \sum_{i=1}^m z_i\] <p>The coordinates of <em>p</em>(<em>c</em>) is the ghost atom for NICS(0) calculation.</p> <p>Next, for NICS(n): we need to add the ghost atom to the height of n Å from the center point of the plane. Here is the common solution:</p> <p align="center"> <img alt="nicsfig1" src="/assets/blog/figure61.png" style="height:200px;"> </p> <p>Vector <em>n</em> is the normal vector of plane Π, so,</p> \[\because \overrightarrow{n} \bot \Pi\] \[\therefore \overrightarrow{n}=\overrightarrow{p_1p_2} \times \overrightarrow{p_1p_3} = \begin{vmatrix} i &amp; j &amp; k \\ x_2-x_1 &amp; y_2-y_1 &amp; z_2-z_1 \\ x_3-x_1 &amp; y_3-y_1 &amp; z_3-z_1 \end{vmatrix} = a \overrightarrow{i} + b \overrightarrow{j} + c \overrightarrow{k} =(a,b,c)\] <p>thus,</p> \[a=(y_2-y_1)(z_3-z_1)-(y_3-y_1)(z_2-z_1)\] \[b=(z_2-z_1)(x_3-x_1)-(z_3-z_1)(x_2-x_1)\] \[c=(x_2-x_1)(y_3-y_1)-(x_3-x_1)(y_2-y_1)\] <p>The vector <em>p</em>(<em>c</em>)<em>p</em>(<em>n</em>) should be parallel with normal vector, so:</p> \[\because \overrightarrow{p_n p_c} \parallel \overrightarrow{n}\] \[\therefore \overrightarrow{p_n p_c} = (x_n-x_c,y_n-y_c,z_n-z_c)=\lambda \overrightarrow{n}\] <p>thus,</p> \[\frac {\overrightarrow{p_n p_c}}{\overrightarrow{n}} = \frac {x_n-x_c}{a} = \frac {y_n-y_c}{b} = \frac {z_n-z_c}{c} =\lambda\] <p>therefore, we can solve the equation to get the values of <em>x</em>(<em>n</em>), <em>y</em>(<em>n</em>) and <em>z</em>(<em>n</em>).</p> <h1 id="3-nics-analyses-of-1-methylazulene">3. NICS analyses of 1-methylazulene</h1> <p>Calculation files in this section could be download from <a href="https://github.com/wongzit/blogFiles/tree/main/blog_NICS" rel="external nofollow noopener" target="_blank">here</a>. 1-Methylazulene was optimized at ωB97X-D/6-31G(d) level of theory with Gaussian 16 B.01 package. The optimized azulene is located on XY plane (Figure1). I want to know the NICS(0) values of 7- and 5-membered rings, and the NICS(1) of 7-membered ring.</p> <p align="center"> <img alt="nicsfig2" src="/assets/blog/figure62.png" style="height:200px;"> </p> <blockquote> <p>Figure 1. Optimized geometry of 1-methylazulene.</p> </blockquote> <p>The input file for NICS calculation was created by NICSgen, the input geometry is shown in Figure 2. For NICS calculation, B3LYP/6-31G+(d) or higher level of theory is recommended.</p> <p align="center"> <img alt="nicsfig3" src="/assets/blog/figure63.png" style="height:200px;"> </p> <blockquote> <p>Figure 2. Input geometry for NICS calculation.</p> </blockquote> <p>We can find the magnetic shielding tensors of these ghost atoms in the output file, and the NICS values are the reversed magnetic shielding tensors:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> NICS(0)zz  =   -7.6656 (7-membered ring)
 NICS(0)zz  =  -30.1781 (5-membered ring)
 NICS(1)zz  =  -19.8181
NICS(-1)zz  =  -19.8172
</code></pre></div></div> <p>This results are in accordance with the <a href="https://wongzit.github.io/2d-icss-analyses-with-icssgen-and-icsscsv/">2D-ICSS</a> and <a href="https://wongzit.github.io/3d-icss-analyses-with-icssgen3d-and-icsscub3d/">3D-ICSS</a> analyses.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/orbital-composition-analysis/">Orbital Composition Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/list-of-all-posts/">List of All Posts</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Dr. Zhe WANG. At <a href="https://www.applchem.eng.osaka-u.ac.jp" target="_blank" rel="external nofollow noopener">Graduate School of Engineering</a>, <a href="https://www.osaka-u.ac.jp/en" rel="external nofollow noopener" target="_blank">The University of Osaka</a>. Last updated: October 03, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>