<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="467xC4SA9a1Jn6phdHuh7P3ddDHyokgW6RBNznYrpUI"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> EPR Prediction with ORCA Program | Zhe WANG, Dr. </title> <meta name="author" content="Zhe WANG, Dr."> <meta name="description" content="Personal homepage of ZW. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon_2.png?747804bee05bfe8f8ad3dbba91dc77aa"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://wongzit.github.io/epr-prediction-with-orca-program/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <img src="/assets/img/favicon_2.png?747804bee05bfe8f8ad3dbba91dc77aa" alt="Site Icon" style="height: 38px;"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Zhe</span> WANG, Dr. </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">research </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/presentations/">presentations </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">programs </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/program/pyaroma/">py.Aroma</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/uvplotter/">uv.Plotter</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/script/">scripts</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/online/molview.html">mol.Viewer</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/links/">links </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">EPR Prediction with ORCA Program</h1> <p class="post-meta"> Created on May 27, 2021 by Zhe Wang </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2021   ·   <i class="fa-solid fa-hashtag fa-sm"></i> ORCA   <i class="fa-solid fa-hashtag fa-sm"></i> Computation </p> </header> <article class="post-content"> <div id="markdown-content"> <p><strong>Contents</strong></p> <ul> <li><a href="https://wongzit.github.io/epr-prediction-with-orca-program/#1-input-file-structure">1. Input File Structure</a></li> <li><a href="https://wongzit.github.io/epr-prediction-with-orca-program/#2-hyperfile-coupling-constant">2. Hyperfine Coupling Constant</a></li> <li><a href="https://wongzit.github.io/epr-prediction-with-orca-program/#3-zero-field-splitting-zfs-prediction">3. Zero-field Splitting (ZFS) Prediction</a></li> <li><a href="https://wongzit.github.io/epr-prediction-with-orca-program/#4-example">4. Example</a></li> <li><a href="https://wongzit.github.io/epr-prediction-with-orca-program/#41-predict-hfc-of-tempo-radical">4.1 Predict HFC of TEMPO radical</a></li> <li><a href="https://wongzit.github.io/epr-prediction-with-orca-program/#42-predict-zfs-of-cyclopentane-13-diyl-diradical">4.2 Predict ZFS of cyclopentane-1,3-diyl diradical</a></li> <li><a href="https://wongzit.github.io/epr-prediction-with-orca-program/#5-end">5. End</a></li> </ul> <h1 id="1-input-file-structure">1. Input File Structure</h1> <p>ORCA input file for EPR calculation have to (at least) include following section: (1) Calculation method, (2) geometry coordinates, and (3) additional keywords section. The (2) geometry coordinates can be inserted in input file, or save the structure as .xyz file in the same dictionary with input file. Here are 2 examples of input file.</p> <p><strong>Input file 1</strong>: including Cartesian coordinates in input file. The coordinates structure is same as those in Gaussian input file.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>! [R/U/ROKS] [method] [basis set] [CPU cores]
* xyz [charge] [spin multiplicity]
 [Cartesian coordinates]
*
%eprnmr
    [EPR keywords section]
end
</code></pre></div></div> <p><strong>Input file 2</strong>: Save the geometry as .xyz file at same dictionary with ORCA input file, the ORCA program will read geometry information from .xyz file.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>! [R/U/ROKS] [method] [basis set] [CPU cores]
* xyzfile [charge] [spin multiplicity] [geometry.xyz]
%eprnmr
    [EPR keywords section]
end
</code></pre></div></div> <p><strong>Details about the input file:</strong></p> <p><u>R/U/ROKS</u>: For restricted Hartree-Fock (HF) calculation, use RKS; for unrestricted HF, use UKS and for restricted-open HF, use ROKS. It is better to use ROKS rather than UKS for D and E tensors prediction (<i>J. Phys. Chem. A</i> <b>2006</b>, <i>110</i>, 12267-12275). For g tensor and HFC, use default (UHF).</p> <p><u>method</u>: Specify the calculation method, like B3LYP, BP, etc.</p> <p><u>basis set</u>: Specify the basis set, like 6-31G(d), etc. EPR-II and EPR-III are widely used basis sets optimized for EPR prediction. ( I always use EPR-II for my calculations due to its high-efficiency. EPR-III is more accurate but much more expensive calculation cost is needed.)</p> <p><u>charge</u> <u>spin multiplicity</u>: Same with Gaussian (e.g., for neutral triplet, use 0 3).</p> <p><u>EPR keywords section</u>: This would be discussed in following section.</p> <p>Keywords <em>AutoAux</em> and <em>RIJCOSX</em> could be added to speed up calculations with introducing a very very small error (usually smaller than basis set errors and much smaller than electronic-structure-method errors). For more information about these keywords, please check the <a href="https://sites.google.com/site/orcainputlibrary/basis-sets/ri-and-auxiliary-basis-sets" rel="external nofollow noopener" target="_blank">ORCA manual</a>.</p> <h1 id="2-hyperfine-coupling-constant">2. Hyperfine Coupling Constant</h1> <p>For predicting hyperfine coupling (HFC), you need to include following keywords in <u>EPR keywords section</u>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> %eprnmr
     gtensor = true
     Nuclei = all N {flags}  # flags = aiso, adip, aorb, fgrad, rho, etc.
     Nuclei = all C {flags}
 end
</code></pre></div></div> <p><u>gtensor</u> flag must be set to true or 1 to compute it.</p> <p><u>Nuclei = ...</u>: This flag defines the atoms for the hyperfine coupling calculations. all H calculates the HFC on all hydrogens, or use all N, all C and so on for different atoms. You can also use Nuclei = 1,5,8 to give one list per atom type (in this example, atom 1,5,8 must be same element) with the atom numbering starting from 1. The {flags} in Nuclei lines requests calculation option for HFC:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> aiso: calculate the isotropic part of the HFC
 adip: calculate the dipolar part of the HFC
 aorb: 2nd order contribution to the HFC from SOC
fgrad: calculate the electric field gradient
  rho: calculate the electron density at the nucleus
</code></pre></div></div> <p>After the calculation is completed, the g tensor and HFC could be read from output file:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-------------------
ELECTRONIC G-MATRIX
-------------------

 The g-matrix: 
              2.0060206    0.0004709   -0.0003205
              0.0006221    2.0032154    0.0023911
             -0.0002906    0.0024341    2.0088349

 gel          2.0023193    2.0023193    2.0023193
 gRMC        -0.0002988   -0.0002988   -0.0002988
 gDSO(tot)    0.0001605    0.0002266    0.0001485
 gPSO(tot)    0.0000400    0.0038717    0.0075621
             ----------   ----------   ----------
 g(tot)       2.0022210    2.0061188    2.0097311 iso=  2.0060236
 Delta-g     -0.0000983    0.0037995    0.0074118 iso=  0.0037043
---------------------------------------------------------------
          Euler rotation of hyperfine tensor to g-tensor
---------------------------------------------------------------

----------------------------------------------------------------
 Atom  |   Alpha    Beta    Gamma   |   Ax       Ay       Az 
       |          [degrees]         |           [MHz]         
----------------------------------------------------------------
  0N       67.4      3.0    -66.1      67.76    -0.70    -0.22
  5H      174.1     28.6   -139.2      -2.86    -2.63     3.86
  6H       47.5     24.4    -77.2      -2.26    -2.34     2.02
  7H      -21.5     27.0     29.3      -0.56    -0.36     5.53
  8H      -82.6     20.1     99.2       2.36     2.43     6.83
  9H       79.0     26.7    -97.0      28.68    41.28    28.42
----------------------------------------------------------------
</code></pre></div></div> <h1 id="3-zero-field-splitting-zfs-prediction">3. Zero-field Splitting (ZFS) Prediction</h1> <p>If you want to predict ZFS parameters for the systems with S &gt; 1/2, please include following keywords in <u>EPR keywords section</u>. Keywords after the # indicate for other options.</p> <p>For UKS calculation:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%eprnmr
    dtensor ssandso   # ss, so
    dss uno           # direct
    dsoc cp           # qro, pk, cvw
end
</code></pre></div></div> <p>For ROKS calculation:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%eprnmr
    dtensor ss
    dss direct
end
</code></pre></div></div> <p><u>dtensor</u> flag has three options for predict the D tensor: (1) ssandso (spin-spin and spin-orbital component), (2) ss (only spin-spin component) and (3) so (only spin-orbital component). All of these three options could be applied in unrestricted (UKS) calculation, but for restricted-open (ROKS) calculation, only spin-spin part (ss) could be estimated.</p> <p><u>dss</u> flag controls the algorithms of calculation of spin-spin component. Two options is available: (1) uno (use spin density from UNOs, this could only be used in UKS calculation) and (2) direct (directly use the canonical orbitals for the spin density).</p> <p><u>dsoc</u> flag controls the algorithms of calculation of spin-orbital component. This is not available in restricted-open calculation. Other options:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> cp: coupled-perturbed method (default)
qro: quasi-restricted method, must be done with keyword !uno
 pk: Pederson-Khanna method
cvw: van Wüllen method
</code></pre></div></div> <p>After the calculation is completed, you could read the ZFS parameters from output file:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>D   =    0.019661  cm**-1
E/D =    0.172867
</code></pre></div></div> <h1 id="4-example">4. Example</h1> <p>Here I put two input files I used for EPR prediction. (TEMPO radical and triplet cyclopentane-1,3-diyl diradical, all geometries were optimized at UB3LYP/6-31G* level of theory with <em>Gaussian 16 B.01</em>). These file could be download from <a href="https://github.com/wongzit/blogFiles/tree/main/blog_epr_orca" rel="external nofollow noopener" target="_blank">here</a>.</p> <h2 id="41-predict-hfc-of-tempo-radical">4.1 Predict HFC of TEMPO radical</h2> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!B3LYP EPR-II Autoaux rijcosx pal8
* xyzfile 0 2 tempo_opt.xyz
%eprnmr
    gtensor 1
    Nuclei = all N {aiso, adip, aorb, fgrad, rho}
    Nuclei = all C {aiso, adip, aorb, fgrad, rho}
end

</code></pre></div></div> <h2 id="42-predict-zfs-of-cyclopentane-13-diyl-diradical">4.2 Predict ZFS of cyclopentane-1,3-diyl diradical</h2> <p>Calculate at ROBP/EPR-II level of theory:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!roks bp epr-ii autoaux rijcosx pal8
* xyz 0 3
 C   1.022000   0.768000  -0.094000
 C   1.022000  -0.768000   0.094000
 C  -0.408000  -1.170000  -0.081000
 C  -1.335000  -0.000000  -0.000000
 C  -0.408000   1.170000   0.081000
 H   1.696000   1.277000   0.607000
 H   1.385000   1.030000  -1.101000
 H   1.385000  -1.030000   1.101000
 H   1.696000  -1.277000  -0.607000
 H  -2.016000   0.056000  -0.871000
 H  -2.016000  -0.056000   0.871000
 H  -0.742000   2.201000   0.123000
 H  -0.742000  -2.201000  -0.123000
*
%eprnmr
    dtensor ss
    dss direct
end
</code></pre></div></div> <p>Calculate at UBP/EPR-II level of theory.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!uks bp epr-ii autoaux rijcosx pal8
* xyz 0 3
 C   1.022000   0.768000  -0.094000
 C   1.022000  -0.768000   0.094000
 C  -0.408000  -1.170000  -0.081000
 C  -1.335000  -0.000000  -0.000000
 C  -0.408000   1.170000   0.081000
 H   1.696000   1.277000   0.607000
 H   1.385000   1.030000  -1.101000
 H   1.385000  -1.030000   1.101000
 H   1.696000  -1.277000  -0.607000
 H  -2.016000   0.056000  -0.871000
 H  -2.016000  -0.056000   0.871000
 H  -0.742000   2.201000   0.123000
 H  -0.742000  -2.201000  -0.123000
*
%eprnmr
    dtensor ssandso
    dss uno
    dsoc cp
end
</code></pre></div></div> <h1 id="5-end">5. End</h1> <p>The EPR prediction of ZFS may get better results from CASSCF method. For more information, please refer to the ORCA official manual (for EPR calculation keywords, from page 888 to page 891 in the manual of version 4.2.1). <a href="https://www.orcasoftware.de/tutorials_orca/spec/EPR.html" rel="external nofollow noopener" target="_blank">This website</a> also have some useful information on EPR calculation with ORCA.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/orbital-composition-analysis/">Orbital Composition Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/list-of-all-posts/">List of All Posts</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Zhe WANG, Dr.. At <a href="https://www.applchem.eng.osaka-u.ac.jp" target="_blank" rel="external nofollow noopener">Graduate School of Engineering</a>, <a href="https://www.osaka-u.ac.jp/en" rel="external nofollow noopener" target="_blank">The University of Osaka</a>. Last updated: October 03, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>