<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="467xC4SA9a1Jn6phdHuh7P3ddDHyokgW6RBNznYrpUI"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Natural Transition Orbitals (NTO) Analysis | Dr. Zhe WANG </title> <meta name="author" content="Dr. Zhe WANG"> <meta name="description" content="Personal homepage of ZW. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.png?f24a494b08a94ccf34977dcf2e676fbd"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://wongzit.github.io/natural-transition-orbitals-(nto)-analysis/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Dr.</span> Zhe WANG </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">research </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/presentations/">presentations </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">programs </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/program/pyaroma/">py.Aroma</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/uvplotter/">uv.Plotter</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/script/">scripts</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/online/molview.html">mol.Viewer</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/links/">links </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Natural Transition Orbitals (NTO) Analysis</h1> <p class="post-meta"> Created on April 28, 2023 by Zhe Wang </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2023   ·   <i class="fa-solid fa-hashtag fa-sm"></i> Gaussian   <i class="fa-solid fa-hashtag fa-sm"></i> Computation </p> </header> <article class="post-content"> <div id="markdown-content"> <h1 id="1-preface">1. Preface</h1> <p>When computing excited sates using CIS, TDHF, TDDFT methods, the transition modes can be expressed as a linear combination of different ways of transition between the occupied orbitals in the ground state and the virtual orbitals. In many cases, only one type of transition has a larger contribution. For example, following is a <em>Gaussian</em> output of acrolein @<code class="language-plaintext highlighter-rouge">RIS/6-31+G*</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Excited State   2:      Singlet-A'     7.0919 eV  174.83 nm  f=0.7713  &lt;S**2&gt;=0.000
      15 -&gt; 16         0.66677
      15 -&gt; 25        -0.13319
</code></pre></div></div> <p>The MO15 -&gt; MO16 transition contributed 88.9% (= 2 x 0.66677^2 x 100%) for excited state S0 -&gt; S2. Therefore, the S0 -&gt; S2 transition can be elucidated by analyzing this dominant orbital transition pattern.</p> <p>On the other hand, for the excited state S0 -&gt; S1 of same molecule:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> Excited State   1:      Singlet-A"     4.6966 eV  263.99 nm  f=0.0003  &lt;S**2&gt;=0.000
      14 -&gt; 16         0.56407
      14 -&gt; 20        -0.21920
      14 -&gt; 25        -0.24192
      14 -&gt; 29        -0.17712
      14 -&gt; 33        -0.13568
</code></pre></div></div> <p>Although MO14 -&gt; MO16 contributed 63.6% of S0 -&gt; S1 transition, this is not sufficient. However, if other orbital transitions with small coefficients are also considered, the analysis will be difficult to identify. Natural Transition Orbitals (NTO) can solve this problem by transforming the molecular orbitals. This allows describing the complex transition with just one transition from an occupied orbital to a virtual orbital, making the analysis much easier.</p> <h1 id="2-nto-analysis">2. NTO Analysis</h1> <h3 id="21-one-step-method">2.1 One-Step Method</h3> <p>As example, the route section of input file for NTO analysis (S0 -&gt; S1) is like:</p> <p><strong>TDDFT</strong>: <code class="language-plaintext highlighter-rouge">#p td b3lyp/6-31g(d) pop=(saveNTO,NTO) density=transition=1</code> <strong>CIS</strong>: <code class="language-plaintext highlighter-rouge">#p cis/6-31g(d) pop=(saveNTO,NTO) density=transition=1</code></p> <p>For further analysis of S0 -&gt; S2 transition, here are 2 options:</p> <ol> <li><code class="language-plaintext highlighter-rouge">#p cis/6-31g(d) pop=(saveNTO,NTO) density=transition=2</code></li> <li> <code class="language-plaintext highlighter-rouge">#p cis(read)/6-31+G* guess=read pop=(saveNTO,NTO) density=transition=2</code>, this method should be faster.</li> </ol> <h3 id="22-multi-step-method">2.2 Multi-Step Method</h3> <p>This method requires an excited state calculation at first.</p> <p><strong>i) Excited State Calculation</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%chk=es.chk
#p td=(nstate=10) b3lyp/6-31g*

[Molecule Specification]
</code></pre></div></div> <p><strong>ii) NTO Calculation</strong></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%oldchk=es.chk
%chk=state_N.chk
#p b3lyp/6-31g* geom=allcheck guess=(read,only) density=(check,transition=N) pop=(saveNTO,NTO)
</code></pre></div></div> <p>For method <strong>2.1</strong> and <strong>2.2</strong>, convert the .chk file to .fchk file, and open it by <em>GaussView</em> to plot the MO. In this example, the transition 15 -&gt; 16 contributed 99.3% to S0 -&gt; S1.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blog/nto-480.webp 480w,/assets/blog/nto-800.webp 800w,/assets/blog/nto-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/blog/nto.png" class="img-fluid" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h3 id="23-via-multiwfn">2.3 via Multiwfn</h3> <p><a href="http://sobereva.com/multiwfn/" rel="external nofollow noopener" target="_blank">Multiwfn</a> also provides a function for NTO analysis. For more detail, please refer to the Section 4.18.6 in user manual.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/orbital-composition-analysis/">Orbital Composition Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/list-of-all-posts/">List of All Posts</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Dr. Zhe WANG. At <a href="https://www.applchem.eng.osaka-u.ac.jp" target="_blank" rel="external nofollow noopener">Graduate School of Engineering</a>, <a href="https://www.osaka-u.ac.jp/en" rel="external nofollow noopener" target="_blank">The University of Osaka</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>