<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="467xC4SA9a1Jn6phdHuh7P3ddDHyokgW6RBNznYrpUI"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 3D-ICSS Analyses with ICSSgen3D and ICSScub3D | Dr. Zhe WANG </title> <meta name="author" content="Dr. Zhe WANG"> <meta name="description" content="Personal homepage of ZW. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.png?f24a494b08a94ccf34977dcf2e676fbd"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://wongzit.github.io/3d-icss-analyses-with-icssgen3d-and-icsscub3d/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <img src="/assets/img/favicon.png?f24a494b08a94ccf34977dcf2e676fbd" alt="Site Icon" style="height: 70px;"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Dr.</span> Zhe WANG </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">research </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/presentations/">presentations </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">programs </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/program/pyaroma/">py.Aroma</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/uvplotter/">uv.Plotter</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/script/">scripts</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/online/molview.html">mol.Viewer</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching </a> </li> <li class="nav-item "> <a class="nav-link" href="/links/">links </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">3D-ICSS Analyses with ICSSgen3D and ICSScub3D</h1> <p class="post-meta"> Created on June 12, 2021 by Zhe Wang </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2021   ·   <i class="fa-solid fa-hashtag fa-sm"></i> Software   <i class="fa-solid fa-hashtag fa-sm"></i> Computation </p> </header> <article class="post-content"> <div id="markdown-content"> <p><strong>ICSSgen3D</strong> and <strong>ICSScub3D</strong> is end of support. The basic functionalities have been combined into <strong>py.Aroma</strong>, a multi-functional tool for aromaticity analyses. Please check the <a href="https://wongzit.github.io/program/pyaroma/">homepage</a> of <strong>py.Aroma</strong> for more information.</p> <p><strong>Contents</strong></p> <ul> <li><a href="https://wongzit.github.io/3d-icss-analyses-with-icssgen3d-and-icsscub3d/#1-statement-of-need">1. Statement of need</a></li> <li><a href="https://wongzit.github.io/3d-icss-analyses-with-icssgen3d-and-icsscub3d/#2-install-and-usage">2. Install and usage</a></li> <li><a href="https://wongzit.github.io/3d-icss-analyses-with-icssgen3d-and-icsscub3d/#3-3d-icss-analyses-of-1-methylazulene">3. 3D-ICSS analyses of 1-methylazulene</a></li> <li><a href="https://wongzit.github.io/3d-icss-analyses-with-icssgen3d-and-icsscub3d/#31-create-input-files-with-icssgen3d">3.1 Create input files with ICSSgen3D</a></li> <li><a href="https://wongzit.github.io/3d-icss-analyses-with-icssgen3d-and-icsscub3d/#32-submit-input-files-to-gaussian-calculation">3.2 Submit input files to Gaussian calculation</a></li> <li><a href="https://wongzit.github.io/3d-icss-analyses-with-icssgen3d-and-icsscub3d/#33-visualize-3d-icss-with-icsscub3d">3.3 Visualize 3D-ICSS with ICSScub3D</a></li> </ul> <h1 id="1-statement-of-need">1. Statement of need</h1> <p>In the previous <a href="https://wongzit.github.io/2d-icss-analyses-with-icssgen-and-icsscsv/">post</a>, I introduced how to plot 2D-ICSS map to investigate the aromaticity. Sometimes, a 3D-ICSS is necessary if the molecular structure is <a href="https://www.nature.com/articles/s41557-019-0399-2" rel="external nofollow noopener" target="_blank">complicate</a>, and it may hard to be presented by 2D-ICSS map. Thus, I developed the 3D version of <a href="https://github.com/wongzit/ICSSgen" rel="external nofollow noopener" target="_blank">ICSSgen</a> and <a href="https://github.com/wongzit/ICSScsv" rel="external nofollow noopener" target="_blank">ICSScsv</a>, the Python programs kit: <a href="https://github.com/wongzit/ICSSgen3D" rel="external nofollow noopener" target="_blank">ICSSgen3D</a> and <a href="https://github.com/wongzit/ICSScub3D" rel="external nofollow noopener" target="_blank">ICSScub3D</a>.</p> <h1 id="2-install-and-usage">2. Install and usage</h1> <p>ICSSgen3D and ICSScub3D could be download from <a href="https://github.com/wongzit" rel="external nofollow noopener" target="_blank"><em>GitHub</em></a>. To install and run the programs, please refer to the user manuals.</p> <h1 id="3-3d-icss-analyses-of-1-methylazulene">3. 3D-ICSS analyses of 1-methylazulene</h1> <h2 id="31-create-input-files-with-icssgen3d">3.1 Create input files with ICSSgen3D</h2> <p>3D-ICSS analyses of 1-methylazulene would be presented in this section. The calculation files in this section could be download from here. The optimization of 1-methylazulene is carried out at ωB97X-D/6-31G(d) level of theory with Gaussian 16 B.01 package.</p> <p>An original input file is prepared, including the route line, calculation method, geometry coordinates. The original input file looks like:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%nprocshared=6
%mem=10GB
%chk=methylazulene.chk
#p nmr=giao rb3lyp/6-31g(d)

optimized_1-methylazulene

0 1
 C            -2.68122300      -0.69593600       0.00002600
 ...
</code></pre></div></div> <p>Next, we need to determine the calculation region. In this calculation, the ghost would be added in the cuboid with X (-7.5, 7.5), Y (-6.5, 6.5) and Z (-6, 6).</p> <div class="col-sm-7 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blog/figure42-480.webp 480w,/assets/blog/figure42-800.webp 800w,/assets/blog/figure42-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/blog/figure42.png" class="img-fluid" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>(For Gaussian 16, the maximum atom number is 8000, so, we need to separate the calculation into several input files. ICSSgen3D will add 7000 ghost atoms in each file, to make sure not to exceed the limitation.)</p> <h2 id="32-submit-input-files-to-gaussian-calculation">3.2 Submit input files to Gaussian calculation</h2> <p>ICSSgen3D would generate several input files, and we need to submit these input files to Gaussian calculation. The input files named from <em>xxx_3DICSS_0001.log</em>, <em>xxx_3DICSS_0002.log</em>, … . From the second input file, the <code class="language-plaintext highlighter-rouge">guess=read</code> keyword is included to save the calculation time by reading MO information from the previous .chk file. So, please save these input files into one folder.</p> <p>I wrote a Bash Shell script (<a href="https://github.com/wongzit/minorScripts" rel="external nofollow noopener" target="_blank">RunGJF</a>) for submit all Gaussian jobs in the same dictionary one by one.</p> <h2 id="33-visualize-3d-icss-with-icsscub3d">3.3 Visualize 3D-ICSS with ICSScub3D</h2> <p>After finishing all calculation, we need to extract the magnetic shielding tensors from the output files. ICSScub3D can do this job for us. We just need to tell the output file path to ICSScub3D, and determine which component (isotropic, anisotropy, ZZ and so on) would be used for 3D-ICSS plot, the program can save the shielding tensor into .cub file automatically. We can visualize the 3D-ICSS plot with the .cub file using GaussView, VMD, Chimera X, etc.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blog/figure43-480.webp 480w,/assets/blog/figure43-800.webp 800w,/assets/blog/figure43-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/blog/figure43.png" class="img-fluid" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/orbital-composition-analysis/">Orbital Composition Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/list-of-all-posts/">List of All Posts</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Dr. Zhe WANG. At <a href="https://www.applchem.eng.osaka-u.ac.jp" target="_blank" rel="external nofollow noopener">Graduate School of Engineering</a>, <a href="https://www.osaka-u.ac.jp/en" rel="external nofollow noopener" target="_blank">The University of Osaka</a>. Last updated: September 30, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>