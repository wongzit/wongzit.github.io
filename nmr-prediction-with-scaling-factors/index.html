<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta name="google-site-verification" content="467xC4SA9a1Jn6phdHuh7P3ddDHyokgW6RBNznYrpUI"> <meta http-equiv="Permissions-Policy" content="interest-cohort=()"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> NMR Prediction with Scaling Factors | Dr. Zhe WANG </title> <meta name="author" content="Dr. Zhe WANG"> <meta name="description" content="Personal homepage of ZW. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%99%93%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://wongzit.github.io/nmr-prediction-with-scaling-factors/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Dr.</span> Zhe WANG </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home </a> </li> <li class="nav-item "> <a class="nav-link" href="/news/">news </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">results </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/publications/">publications</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/presentations/">presentations</a> </div> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">programs </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/program/pyaroma/">py.Aroma</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/uvplotter/">uv.Plotter</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/program/script/">scripts</a> </div> </li> <li class="nav-item "> <a class="nav-link" href="/links/">links </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">NMR Prediction with Scaling Factors</h1> <p class="post-meta"> Created on September 03, 2021 by Zhe Wang </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2021   ·   <i class="fa-solid fa-hashtag fa-sm"></i> Gaussian   <i class="fa-solid fa-hashtag fa-sm"></i> Computation </p> </header> <article class="post-content"> <div id="markdown-content"> <script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script> <script type="text/x-mathjax-config">
 MathJax.Hub.Config({
 tex2jax: {
 inlineMath: [['$', '$'] ],
 displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
 }
 });
</script> <p><strong>Note:</strong> Input and output files could be found <a href="https://github.com/wongzit/blogFiles/tree/main/blog_nmr_prediction" rel="external nofollow noopener" target="_blank">here</a>.</p> <p><strong>Contents</strong></p> <ul> <li><a href="https://wongzit.github.io/nmr-prediction-with-scaling-factors/#1-input">1. Input</a></li> <li><a href="https://wongzit.github.io/nmr-prediction-with-scaling-factors/#2-output">2. Output</a></li> <li><a href="https://wongzit.github.io/nmr-prediction-with-scaling-factors/#3-improve-accuracy-with-scaling-factor">3. Improve accuracy with scaling factor</a></li> <li><a href="https://wongzit.github.io/nmr-prediction-with-scaling-factors/#4-add-more-references-in-gaussview">4. Add more references in <em>GaussView</em></a></li> <li><a href="https://wongzit.github.io/nmr-prediction-with-scaling-factors/#5-apply-scaling-factor-with-pynmr">5. Apply scaling factor with py.NMR</a></li> </ul> <h1 id="1-input">1. Input</h1> <p>An example of NMR calculation for benzene in <em>d</em>-chloroform will be discussed in this post. The geometry of benzene was optimized at B3LYP/6-311+G(2d,p) level of theory in gas phase. The input file for optimization is attached following:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%nprocshared=8
%mem=10GB
#p opt rb3lyp/6-311+g(2d,p)

Benzene//optimization

0 1
 C                  0.12565445    0.25654450    0.00000000
 C                  1.52081445    0.25654450    0.00000000
 C                  2.21835245    1.46429550    0.00000000
 C                  1.52069845    2.67280450   -0.00119900
 C                  0.12587345    2.67272650   -0.00167800
 C                 -0.57172755    1.46452050   -0.00068200
 H                 -0.42410455   -0.69577250    0.00045000
 H                  2.07032245   -0.69596850    0.00131500
 H                  3.31803245    1.46437550    0.00063400
 H                  2.07089845    3.62494750   -0.00125800
 H                 -0.42424855    3.62500750   -0.00263100
 H                 -1.67133155    1.46470350   -0.00086200

</code></pre></div></div> <p>The optimized geometry is used for NMR (NMR=GIAO) calculation at B3LYP/6-311+G(2d,p) level of theory with SMD solvation model of chloroform.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>%nprocshared=8
%mem=10GB
#p nmr=giao rb3lyp/6-311+g(2d,p) scrf=(smd,solvent=chloroform)

Benzene//NMR

0 1
 C                 -0.01990700   -1.39174700    0.00000100
 C                  1.19536900   -0.71306400   -0.00000700
 C                  1.21525700    0.67862700    0.00001100
 C                  0.01984500    1.39174800   -0.00000100
 C                 -1.19533800    0.71311600   -0.00000800
 C                 -1.21522700   -0.67868000    0.00000600
 H                 -0.03531700   -2.47537300   -0.00000600
 H                  2.12604500   -1.26833800   -0.00000900
 H                  2.16140200    1.20710800   -0.00000200
 H                  0.03539700    2.47537200    0.00000200
 H                 -2.12608400    1.26827300   -0.00001000
 H                 -2.16144000   -1.20704000    0.00001600

</code></pre></div></div> <h1 id="2-output">2. Output</h1> <p>Open the output file with <em>GaussView</em>, go to “Results -&gt; NMR”, choose “H” from “element”, we could get the magnetic shielding tensors σ (in ppm).</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blog/figure101-480.webp 480w,/assets/blog/figure101-800.webp 800w,/assets/blog/figure101-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/blog/figure101.png" class="img-fluid" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>You could also use “Reference” like TMS, to get the chemical shift δ, to compare with experimental data.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blog/figure102-480.webp 480w,/assets/blog/figure102-800.webp 800w,/assets/blog/figure102-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/blog/figure102.png" class="img-fluid" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <p>In this demo calculation, the computed shielding tensors <em>σ</em> for all protons are <strong>24.0925</strong>, <strong>24.0931</strong> and <strong>24.1077</strong> ppm, the chemical shift <em>δ</em> are <strong>7.7896</strong>, <strong>7.7890</strong> and <strong>7.7744</strong>. The experimental chemica shift of benzene in <em>d</em>-chloroform is <strong>7.36</strong>.</p> <h1 id="3-improve-accuracy-with-scaling-factor">3. Improve accuracy with scaling factor</h1> <p>Empirical scaling technique could improve the accuracy using scaling factors. <a href="http://cheshirenmr.info/index.htm" rel="external nofollow noopener" target="_blank">CHESHIRE</a> is a website with a lot of scaling factors at different calculation levels. Visit this website and go to “Scaling factor”, we could find this:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Table #1b: 1H and 13C scaling factors for 14 Chloroform DFT and Wavefunction methods (G09 - SMD solvation model)

Geometry (opt&amp;freq): B3LYP/6-311+G(2d,p) (gas phase)
NMR (nmr=method): B3LYP/6-311+G(2d,p) (giao, scrf)
</code></pre></div></div> <p>is exactly what we want. We need the <code class="language-plaintext highlighter-rouge">slope = -1.0781</code> and <code class="language-plaintext highlighter-rouge">intercept = 31.9786</code>, and we could calculate the scaled chemical shift <em>δ_scaled</em> with following equation:</p> \[\delta = \frac {intercept - \sigma}{- slope}\] <ul> <li> <em>δ_scaled</em> (ppm): Chemical shift after applied with scaling factor</li> <li>slope and intercept: Scaling factors from <a href="http://cheshirenmr.info/index.htm" rel="external nofollow noopener" target="_blank">CHESHIRE</a> </li> <li> <em>σ</em> (ppm): Computed magnetic shielding tensors from Gaussian output</li> </ul> <p>So, the scaled chemical shift <em>δ_scaled</em> in this demo calculation are <strong>7.3148</strong>, <strong>7.3143</strong> and <strong>7.3007</strong>, much closer to the experimental value than those before scaling.</p> <h1 id="4-add-more-references-in-gaussview">4. Add more references in <em>GaussView</em> </h1> <ol> <li>Open the <em>GaussView</em> dictionary, open the <code class="language-plaintext highlighter-rouge">nmr.data</code> in <code class="language-plaintext highlighter-rouge">data</code> folder with text edit. For macOS users, the <code class="language-plaintext highlighter-rouge">nmr.data</code> locates at <code class="language-plaintext highlighter-rouge">/Applications/gv/data/nmr.data</code>.</li> <li>Add the references at the end of file, for example: <strong>H 32.3685 “TMS wB97XD/6-31+G(d,p) GIAO”</strong> </li> <li>Re-open <em>GaussView</em>, you could find the new reference in NMR window.</li> </ol> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blog/figure103-480.webp 480w,/assets/blog/figure103-800.webp 800w,/assets/blog/figure103-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/blog/figure103.png" class="img-fluid" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <h1 id="5-apply-scaling-factor-with-pynmr">5. Apply scaling factor with py.NMR</h1> <blockquote> <p><strong>py.NMR</strong> is end of support. The basic functionalities have been combined into <strong>py.Aroma</strong>, a multi-functional tool for aromaticity analyses. Please check the <a href="https://wongzit.github.io/program/pyaroma/">homepage</a> of <strong>py.Aroma</strong> for more information.</p> </blockquote> <p>py.<strong>NMR</strong> is a Python program for applying scaling factors to computed shielding tensors. The latest version of py.<strong>NMR</strong> could be freely download from <a href="https://github.com/wongzit/pyNMR" rel="external nofollow noopener" target="_blank">GitHub</a>.</p> <p align="center"> <img alt="pynmr" class="icon" src="/assets/program/pyNMR_icon.png" style="height:106px; background-color:transparent;"> </p> <p>In py.<strong>NMR</strong>, <em>Lorentzian function</em> for line broadening will be applied to the scaled chemical shift, and the sprctrum data would be saved in an Excel .xlsx file at the same dictionary as the Gaussian output.</p> \[L(x) = \frac {FWHM}{2 \pi} \frac {1}{(x-x_i)^2 + 0.25 \times FWHM^2}\] <p>Users can plot the scaled NMR spectrum with the data points in Excel file. More detail about usage of py.<strong>NMR</strong>, please refer to the user manual on <a href="https://github.com/wongzit/pyNMR" rel="external nofollow noopener" target="_blank">GitHub</a>.</p> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/blog/figure111-480.webp 480w,/assets/blog/figure111-800.webp 800w,/assets/blog/figure111-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/blog/figure111.jpg" class="img-fluid" width="100%" height="auto" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/orbital-composition-analysis/">Orbital Composition Analysis</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/list-of-all-posts/">List of All Posts</a> </li> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Dr. Zhe WANG. At <a href="https://www.applchem.eng.osaka-u.ac.jp" target="_blank" rel="external nofollow noopener">Graduate School of Engineering</a>, <a href="https://www.osaka-u.ac.jp/en" rel="external nofollow noopener" target="_blank">The University of Osaka</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>